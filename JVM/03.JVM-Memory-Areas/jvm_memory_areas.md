# JVM 内存区域

![JVM-03-1][JVM-03-1]

JVM 内存区域主要分为：线程私有区域「程序计数器、虚拟机栈、本地方法区」，线程共享区域「Java 堆、方法区」，直接内存。

线程私有数据区域生命周期与线程相同，依赖用户线程的创建与消亡。在 HotSpot VM 内，每个线程都与操作系统的本地线程直接映射，因此这部分内存区域跟随本地线程创建消亡。

线程共享区域跟随 JVM 虚拟机实例的启停而创建消亡。

直接内存又称堆外内存，并不是 JVM 运行时数据区的一部分，但也会被频繁使用到，如：JDK 1.4 引入`NIO`功能。

## 程序计数器

一块较小的内存空间，存储当前线程所执行的字节码的行号指示器。每条线程都要有一个独立的程序计数器，执行 Java 方法时，程序计数器记录虚拟机字节码指令地址（当前指令的地址），执行 Native 方法时，则为空。

程序计数器内存区域是唯一一个在虚拟机规范中没有规定任何`OutOfMemoryError`情况的内存区域。

## 虚拟机栈

## 本地方法区

本地方法区和 Java 栈的作用类似，区别是虚拟机栈为执行 Java 方法服务，而本地方法栈则为执行 Native 方法服务。如果一个 JVM 实现使用 C-linkage 模型来支持 Native 调用，那么该栈将会是一个 C 栈。在 HotSpot VM 中，直接将本地方法栈和虚拟机栈合二为一了。

## 堆

线程共享的一块内存区域，Java 中创建的对象和数组都保存在 Java 堆中。Java 堆也是垃圾收集器进行垃圾收集最主要的内存区域。

由于现代 VM 采用分代垃圾收集算法，因此 Java 堆从 GC 的角度还可以细分为：新生代（Eden 区、From Survivor 区、To Survivor 区）和老年代。


## 永久代方法区


[JVM-03-1]: ..

<!-- EOF -->
